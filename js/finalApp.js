//MAP SETUP
mapboxgl.accessToken = 'pk.eyJ1Ijoic3lkbmciLCJhIjoiY2pmY3JuM2x3M3poYjJ3bzFwZmV4ZHdwdCJ9.H7Kk8jKeATVVDR9qaVxU2Q';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/dark-v9',
    zoom: 11,
    center: [-95.523752,30.177220]
});

map.addControl(new mapboxgl.NavigationControl());

//GEOJSON URLs

var theCoords = {
  "type": "MultiPolygon",
  "coordinates": [ [ [
                  [ 261831.382000356825301, 3338405.345794387627393 ],
                  [ 262525.914639420516323, 3338736.075622516684234 ],
                  [ 262807.034993326640688, 3338719.539131111465394 ],
                  [ 262988.936398798541632, 3338504.564742826391011 ],
                  [ 262807.034993326640688, 3338256.517371733207256 ],
                  [ 262773.962010513758287, 3338124.225440484005958 ],
                  [ 262889.717450359952636, 3337958.860526417382061 ],
                  [ 262889.717450359952636, 3337793.495612353086472 ],
                  [ 262972.399907393206377, 3337545.448241259902716 ],
                  [ 263220.44727848644834, 3337528.911749856546521 ],
                  [ 263385.812192548590247, 3337776.959120949730277 ],
                  [ 263518.104123800119851, 3337991.933509232476354 ],
                  [ 263749.615003487968352, 3338074.61596626136452 ],
                  [ 263716.542020675144158, 3337843.105086573399603 ],
                  [ 263865.37044333195081, 3337727.349646731745452 ],
                  [ 264014.198865988757461, 3337495.838767041452229 ],
                  [ 263964.589391770539805, 3337363.546835792250931 ],
                  [ 263782.687986298638862, 3337231.254904540721327 ],
                  [ 263650.396055049379356, 3337082.426481881644577 ],
                  [ 263666.932546456926502, 3336900.525076416321099 ],
                  [ 263997.662374583422206, 3336950.134550632443279 ],
                  [ 263914.979917550168466, 3336635.941213913727552 ],
                  [ 263964.589391770539805, 3336404.430334223434329 ],
                  [ 264080.344831616734155, 3336321.74787718988955 ],
                  [ 264295.319219897093717, 3336057.164014696143568 ],
                  [ 264295.319219897093717, 3335792.580152188427746 ],
                  [ 264295.319219897093717, 3335594.142255313694477 ],
                  [ 264196.100271458446514, 3335478.386815469712019 ],
                  [ 264113.417814425192773, 3335379.1678670309484 ],
                  [ 264295.319219897093717, 3335362.631375628057867 ],
                  [ 264460.684133959235623, 3335279.948918594513088 ],
                  [ 264592.976065208495129, 3335114.584004527889192 ],
                  [ 264592.976065208495129, 3334932.682599062565714 ],
                  [ 264411.074659741017967, 3334866.536633434705436 ],
                  [ 264311.855711300217081, 3334701.171719376929104 ],
                  [ 264146.490797240287066, 3334519.270313902758062 ],
                  [ 263964.589391770539805, 3334420.05136546632275 ],
                  [ 263815.760969111521263, 3334320.832417028024793 ],
                  [ 263716.542020675144158, 3334188.540485776495188 ],
                  [ 263997.662374583422206, 3334089.321537342388183 ],
                  [ 264146.490797240287066, 3333841.274166248738766 ],
                  [ 264080.344831616734155, 3333609.763286556582898 ],
                  [ 263931.516408957715612, 3333378.252406866289675 ],
                  [ 263733.078512082691304, 3333113.66854436788708 ],
                  [ 263567.71359802049119, 3333262.496967022307217 ],
                  [ 263336.202718330372591, 3333494.007846714928746 ],
                  [ 263038.545873018971179, 3333609.763286556582898 ],
                  [ 262807.034993326640688, 3333510.544338117819279 ],
                  [ 262575.524113638733979, 3333609.763286556582898 ],
                  [ 262261.330776919785421, 3333593.226795149035752 ],
                  [ 261914.064457385684364, 3333460.934863899834454 ],
                  [ 261748.699543323542457, 3333444.39837249647826 ],
                  [ 261500.652172228088602, 3333560.153812340460718 ],
                  [ 261252.604801134875743, 3333444.39837249647826 ],
                  [ 260789.583041756850434, 3333460.934863899834454 ],
                  [ 260657.291110505349934, 3333642.836269374005497 ],
                  [ 260690.364093318232335, 3334006.639080308843404 ],
                  [ 260888.801990195468534, 3334320.832417028024793 ],
                  [ 260888.801990195468534, 3334585.416279528755695 ],
                  [ 260723.437076133326627, 3334883.073124844580889 ],
                  [ 260607.681636287161382, 3335114.584004527889192 ],
                  [ 260425.78023081968422, 3335313.021901409607381 ],
                  [ 260326.561282378825126, 3335577.605763910338283 ],
                  [ 260624.218127696920419, 3335643.751729536335915 ],
                  [ 260558.072162066731835, 3335809.116643595974892 ],
                  [ 260310.024790973518975, 3335891.799100629519671 ],
                  [ 260359.634265191707527, 3336007.554540471173823 ],
                  [ 260425.78023081968422, 3336288.674894379451871 ],
                  [ 260359.634265191707527, 3336553.258756882511079 ],
                  [ 260260.415316755301319, 3336751.696653757244349 ],
                  [ 260260.415316755301319, 3336966.671042039990425 ],
                  [ 260210.805842537112767, 3337115.499464699067175 ],
                  [ 260012.367945659847464, 3337280.864378756843507 ],
                  [ 259780.85706597196986, 3337198.181921725627035 ],
                  [ 259615.492151909798849, 3337413.156310008373111 ],
                  [ 259268.225832375726895, 3337181.645430322736502 ],
                  [ 259317.835306596156443, 3337644.667189698200673 ],
                  [ 259185.543375344655942, 3337843.105086573399603 ],
                  [ 259020.178461280302145, 3338008.470000635366887 ],
                  [ 258920.959512843895936, 3338239.98088032566011 ],
                  [ 259003.64196987496689, 3338587.24719985993579 ],
                  [ 259284.76232378106215, 3338884.904045175760984 ],
                  [ 259651.415033842407865, 3339323.293155028484762 ],
                  [ 260045.440928474941757, 3339794.411072519607842 ],
                  [ 260185.187133055267623, 3339554.846150384284556 ],
                  [ 260276.951808162848465, 3339397.535278769675642 ],
                  [ 260591.145144881826127, 3339248.706856110598892 ],
                  [ 260835.87872005533427, 3339094.615345817990601 ],
                  [ 261037.630412852304289, 3338967.58650220464915 ],
                  [ 260872.265498787921388, 3338752.612113921903074 ],
                  [ 260706.900584725779481, 3338488.028251418843865 ],
                  [ 260458.853213630325627, 3338124.225440484005958 ],
                  [ 260475.389705037872773, 3337826.568595168180764 ],
                  [ 260706.900584725779481, 3337644.667189698200673 ],
                  [ 260905.338481600803789, 3337644.667189698200673 ],
                  [ 261384.896732386376243, 3337644.667189698200673 ],
                  [ 261649.480594887136249, 3337991.933509232476354 ],
                  [ 261831.382000356825301, 3338405.345794387627393 ]
                ] ] ]
};

//CREATE WEBPAGE
$(document).ready(function(){

    $('#sidebar').hide();
    $('#about').hide();
    $('#myModal').modal('show');

    $('#exploreButton').on('click', function() {
      $('#sidebar').show();
    });

    $('#inundBox').click(function() {
      if($('#inundBox').prop("checked")) {
        map.addLayer({
          "id": "woodlands",
          "type": "heatmap",
          "source": {
            "type": "vector",
            "tiles": ["https://s3.us-east-2.amazonaws.com/jswoods/{z}/{x}/{y}.pbf"],
            "minzoom": 0,
            "maxzoom": 19
          },
          "source-layer": "WoodlandsPoints",
          "paint": {
            "heatmap-weight": [
                "interpolate",
                ["linear"],
                ["get", "Inundation"],
                0, 0,
                3, 1
            ],
            "heatmap-color": [
                "interpolate",
                ["linear"],
                ["heatmap-density"],
                0, "rgba(33,102,172,0)",
                0.2, "rgb(103,169,207)",
                0.4, "rgb(209,229,240)",
                0.6, "rgb(253,219,199)",
                0.8, "rgb(239,138,98)",
                1, "rgb(178,24,43)"
            ],
            'heatmap-opacity': 0.8
          }
        });
        map.addSource("woodlands");
      } else {
        map.removeSource("woodlands");
        map.removeLayer("woodlands");
      }
    });

    $('#phases').click(function() {
      if($('#phases').prop("checked")) {
        map.addSource("phases", {
          "type": "geojson",
          "data": {
              "type": "Feature",
              "properties": { "Area": 19306600.0,
                              "Id": 1,
                              "Inundation": 614952
                            },
              "geometry": theCoords
          }
        });
        map.addLayer({
          "id": "phases",
          "type": "line",
          "source": "phases",
          "layout": {
          },
          "paint": {
          }
        });
      } else {
        map.removeLayer("phases");
        map.removeSource("phases");
      }
    });

    $('#aboutButton').on('click', function() {
      $('#myModal').modal('show');
      $('#map').css('top', '75px');
    });

    $('#resourceButton').on('click', function() {
      $('#map').css('top', 'auto');
    });

    $('#closeIcon').on('click', function() {
      $('#sidebar').hide();
    });
  /*});*/
});
